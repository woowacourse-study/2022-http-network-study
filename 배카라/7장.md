# HTTPS 공개키 암호화 방식

간단 요약 

### 1. 서버는 CA에게 서버의 공개키를 제출

- CA는 자신의 CA 비공개키를 이용해 인증서를 암호화한다. (공개키 방식)
- CA는 암호화된 인증서를 서버에게 준다.
- 인증서 안에는 서버의 **공개키** + **서비스의 정보** (공개키의 내용  + 공개키 암호화 방법)

<br>

### 2. client hello - 클라이언트가 서버에 접속
- 클라이언트가 어떤 암호화 방식을 사용할 것인지 서버로 전달 
- **랜덤 데이터**도 전달

<br>

### 3. server hello
- 서버가 브라우저에게 인증서를 제공한다.
- 서버에서도 **랜덤 데이터**를 제공한다.
  
<br>


### 4. 브라우저에서 인증서 확인
- 브라우저는 내부에 CA의 리스트와 각 CA의 공개키를 가지고 있다. 
- 브라우저는 CA의 공개키를 이용해 인증서를 복호화하여 서버의 **공개키**를 얻는다.
  ( CA의 공개키에 의해 복호화한다는 것은 서버가 CA에 의해서 발급된 인증서라는 뜻~ 고로 믿을만 하다.)

<br>


### 5. pre master secrete key 생성
- **서버의 랜덤 데이터 + 클라이언트의 랜덤 데이터**를 이용하여 **pre master secrete key**를 생성

<br>


### 6. 서버에게 pre master secrete key 키 전달하기
- 브라우저는 인증서를 통해 얻은 서버의 **공개키**로 **pre master secrete key**를 암호화한다.
- 그리고 서버에게 전송한다.
- 이제 클라이언트와 서버는 같은 키를 공유하게 되었다.
- 어찌 어찌 해서 **pre master secrete key**를 세션 키로 만든다.

<br>


### 7. 클라이언트와 서버는 핸드 쉐이크 종료를 서로에게 알린다.

### 8. 데이터를 주고 받을 때 공유하고 있는 세션키를 이용해서 공통키 방식으로 암호화한다.
- 데이터를 받은 쪽은 공유하고 있는 세션키를 이용해서 공통키 방식으로 복호화하면 댐 ~

### 9. 데이터 전송이 끝나면 세션키를 폐기